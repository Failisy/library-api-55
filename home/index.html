<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>도서 목록</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>도서 목록</h1>
    </header>
    <main>
        <table id="book-list">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>ISBN</th>
                    <th>제목</th>
                    <th>저자</th>
                    <th>출판사</th>
                    <th>대출 가능 여부</th>
                </tr>
            </thead>
            <tbody>
                <!-- 도서 목록이 여기에 표시됩니다 -->
            </tbody>
        </table>
    </main>

    <script>
        // GitHub Actions에서 환경 변수를 HTML 빌드 시 교체하도록 설정합니다.
        const apiKey = "{{API_KEY}}";  // 빌드 후 교체되는 부분
        const sheetId = "{{SHEET_ID}}";  // 빌드 후 교체되는 부분

        async function fetchBookList() {
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/books?key=${apiKey}`;

            try {
                const response = await fetch(url);
                const data = await response.json();

                if (!data.values || data.values.length === 0) {
                    throw new Error("데이터가 없습니다.");
                }

                const bookList = data.values;
                const tableBody = document.querySelector('#book-list tbody');

                // 첫 번째 행은 헤더이므로 두 번째 행부터 시작
                for (let i = 1; i < bookList.length; i++) {
                    const book = bookList[i];
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${book[0]}</td> <!-- ID -->
                        <td>${book[1]}</td> <!-- ISBN -->
                        <td>${book[2]}</td> <!-- 제목 -->
                        <td>${book[3]}</td> <!-- 저자 -->
                        <td>${book[4]}</td> <!-- 출판사 -->
                        <td>${book[5]}</td> <!-- 대출 가능 여부 -->
                    `;
                    tableBody.appendChild(row);
                }
            } catch (error) {
                console.error('도서 목록을 가져오는 중 오류가 발생했습니다:', error);
            }
        }

        // 페이지 로드 시 도서 목록을 가져옵니다.
        window.onload = fetchBookList;
    </script>

    <script src="script.js"></script>
</body>
</html>
